---     ### TEST AUTH

test_name: Test /login (fail)
stages:
  - name: Compruebo que no hace login sin user ni pass
    request:
      url: https://ipcontainer.herokuapp.com/login
      method: GET
    response:
      status_code: 401

---

test_name: Tests /APIUser
stages:
  - name: Compruebo que hace login y devuelve token - Tests /APIUser
    request:
      url: https://ipcontainer.herokuapp.com/login
      method: GET
      auth:
        - angel   # user
        - angel   # pass
    response:
      status_code: 200
      save:
        body:
          test_token: token

  - name: Compruebo que devuelve 401 si no le paso token - Tests /APIUser
    request:
      url: https://ipcontainer.herokuapp.com/APIUser
      method: GET
    response:
      status_code: 401

  - name: Compruebo el numero de usuarios. - Tests /APIUser
    request:
      url: https://ipcontainer.herokuapp.com/APIUser
      method: GET
      headers:
        x-access-token: "{test_token}"
    response:
      status_code: 200
      # body:
      #   noofusers: 4